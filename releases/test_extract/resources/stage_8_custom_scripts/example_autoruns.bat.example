:: Example Stage 8 Script: Autoruns
:: This script demonstrates how to use the fetch_external_tool.ps1 helper to
:: download, run, and clean up a tool automatically.
::
:: To enable this script, remove the ".example" extension (rename to .bat).

@echo off
set "FUNC_PATH=%~dp0..\functions\fetch_external_tool.bat"
set "LOG_FILE=%~dp0autoruns_log.csv"

echo   [Custom] Fetching and running Sysinternals Autoruns...
echo   [Custom] Saving log to %LOG_FILE%

:: Call the Helper Script
:: URL: https://live.sysinternals.com/autorunsc.exe
:: Tool: autorunsc.exe
:: Args: -a * -c -h -s -t -o "%LOG_FILE%" (Scan everything, CSV format, Hash, Verify signatures, Timestamp, Output to file)

call "%FUNC_PATH%" -Url "https://live.sysinternals.com/autorunsc.exe" -ToolName "autorunsc.exe" -Args "-a * -c -h -s -t -o '%LOG_FILE%'"

echo   [Custom] Autoruns scan complete.
